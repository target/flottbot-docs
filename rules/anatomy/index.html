<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">

<head>
    <!-- 
    This code was adapted from mdBook (https://github.com/rust-lang-nursery/mdBook/),
    with additional modifications by Target Corporation, including:
    
    - moved file to use .html extension
    - updated template syntax to work with site generator used
    - removed path_to_root variable in js snippet
    - inlined menu (toc) content
    - modified navigation
    - removed jax-related content
    - removed theme js files
    
    The original Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0 (the “MPL”) and the
    copyright notice below. If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
    
    Copyright (c) 2018 [wirelyre wirelyre@gmail.com, Matt Ickstadt mattico8@gmail.com, cetra3 cetra3@hotmail.com, 
    Matt Brubeck mbrubeck@gmail.com, Sorin Davidoi sorin.davidoi@gmail.com, Michael Bryan michaelfbryan@gmail.com,
    Mario Nebl marionebl@users.noreply.github.com, Shane Nelson stgn@users.noreply.github.com, lifta42 lifta42@outlook.com, 
    projektir oprojektir@gmail.com, François mockersf@gmail.com, Mathieu David mathieudavid@mathieudavid.org]
    
    The modifications to the original Source Code Form subject to the terms of the MPL and distributed under the copyright notice below.
    Copyright (c) 2018 Target Brands, Inc. 
    -->
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Anatomy of a Rule - Flottbot Documentation</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff" />

    <link rel="shortcut icon" href="https://target.github.io/flottbot-docs/favicon.png">

    
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/variables.css">
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/general.css">
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/chrome.css">
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/print.css" media="print">
    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/highlight.css">
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/tomorrow-night.css">
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/ayu-highlight.css">
    

    <!-- Fonts -->
    <link rel="stylesheet" href="https://target.github.io/flottbot-docs/FontAwesome/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
        rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

    
    

    
    
</head>

<body class="light">
    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script type="text/javascript">
        try {
            var theme = localStorage.getItem('mdbook-theme');
            var sidebar = localStorage.getItem('mdbook-sidebar');

            if (theme.startsWith('"') && theme.endsWith('"')) {
                localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
            }

            if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) {}
    </script>

    <!-- Set the theme before any content is loaded, prevents flash -->
    <script type="text/javascript">
        var theme;
        try {
            theme = localStorage.getItem('mdbook-theme');
        } catch (e) {}
        if (theme === null || theme === undefined) {
            theme = 'ayu';
        }
        document.body.className = theme;
        document.querySelector('html').className = theme + ' js';
    </script>

    <!-- Hide / unhide sidebar before it is displayed -->
    <script type="text/javascript">
        var html = document.querySelector('html');
        var sidebar = 'hidden';
        if (document.body.clientWidth >= 1080) {
            try {
                sidebar = localStorage.getItem('mdbook-sidebar');
            } catch (e) {}
            sidebar = sidebar || 'visible';
        }
        html.classList.remove('sidebar-visible');
        html.classList.add("sidebar-" + sidebar);
    </script>

    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        
        
        <nav role="navigation">
            <ul>
                
                
                
                
                <li >
                    
                    <strong><a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;about&#x2F;" class="subsection-title">
                            
                            What is Flottbot?
                        </a></strong>
                    
                </li>
                
                
                <li >
                    
                    <strong><a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;basics&#x2F;" class="subsection-title">
                            
                            Flottbot Basics
                        </a></strong>
                    
                    <ul>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;basics&#x2F;quick-start&#x2F;" class="page-title">
                                
                                Quick Start
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;basics&#x2F;slack&#x2F;" class="page-title">
                                
                                Slack
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;basics&#x2F;discord&#x2F;" class="page-title">
                                
                                Discord
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;basics&#x2F;google-chat&#x2F;" class="page-title">
                                
                                Google Chat
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;basics&#x2F;customization&#x2F;" class="page-title">
                                
                                Customizing Your Bot
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                
                <li >
                    
                    <strong><a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;actions&#x2F;" class="subsection-title">
                            
                            Actions
                        </a></strong>
                    
                    <ul>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;actions&#x2F;http&#x2F;" class="page-title">
                                
                                HTTP
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;actions&#x2F;exec&#x2F;" class="page-title">
                                
                                exec
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;actions&#x2F;log&#x2F;" class="page-title">
                                
                                log
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;actions&#x2F;message&#x2F;" class="page-title">
                                
                                message
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                
                <li >
                    
                    <strong><a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;rules&#x2F;" class="subsection-title">
                            
                            Rules
                        </a></strong>
                    
                    <ul>
                        
                        <li class="active" >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;rules&#x2F;anatomy&#x2F;" class="page-title">
                                
                                Anatomy of a Rule
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;rules&#x2F;variables&#x2F;" class="page-title">
                                
                                Variables
                            </a>
                        </li>
                        
                        <li >
                            <a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;rules&#x2F;example&#x2F;" class="page-title">
                                
                                Examples
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                
                <li >
                    
                    <strong><a href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;acknowledgements&#x2F;" class="subsection-title">
                            
                            Acknowledgements
                        </a></strong>
                    
                </li>
                
                
            </ul>
        </nav>
        
        
    </nav>

    <div id="page-wrapper" class="page-wrapper">

        <div class="page">
            <div id="menu-bar" class="menu-bar">
                <div id="menu-bar-sticky-container">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                            aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme"
                            aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu <span class="default">(default)</span></button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                            aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Flottbot Documentation</h1>
                </div>
            </div>

            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search for ..."
                        aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>

            <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
            <script type="text/javascript">
                document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                    link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                });
            </script>

            <div id="content" class="content">
                <main>
                    
    <h1>Anatomy of a Rule</h1>
    <p>A standard rule yaml file will look like this:</p>
<pre data-lang="yaml" class="language-yaml "><code class="language-yaml" data-lang="yaml"># metadata
name: echo #name of your rule
active: true # activate rule

# trigger & arguments. you will use of of the below options per rule, not all 3! (respond, hear, schedule)

respond: echo # text match to trigger this rule to take action, bot is looking for the word "echo".
args: # this is an array of args to pass in after a match is found
  - message # first string capture after the match will be mapped to the variable ${message}
  - arg? # this second argument is optional and will be available as ${arg}, ie. the rule will process even if this argument is missing.

hear: "bots are cool" # text match to trigger rule on if that phrase/regex pattern comes up in a room the bots been invited to. Hear currently takes no arguments.

schedule: "@every 10s" # cronspec for when you want a rule to be triggered on a schedule/interval. Schedule takes no arguments.
# example working cron specs:
# - 0 * * * * (at minute 0)
# - @every 1m
# - @every 10s

# Respond to a reaction added or removed from a message in channel
reactions_added: "question" # the text name of the emoji used, can be a regexp with multiple like `(plusone|plus_one|plus1)`
reactions_removed: "question" # the text name of the emoji used, can be a regexp with multiple like `(plusone|plus_one|plus1)`

reaction: eyes # this will prompt the bot to add an emoji reaction to the message that triggered the rule. This emoji reaction can be modified later when actions are taken.

# actions
actions: # this rule takes no actions, just collects and responds with what is laid out in the format_output section

# response
format_output: "${message}" # slack specific message formatting

allow_users: # restrict usage to certain users
  - Jane.Doe
allow_usergroups: # restrict usage to certain usergroups

allow_user_ids: # restrict usage to certain user ids
 - F123456

ignore_users: # users in this list won't trigger this rule
  - John.Doe
ignore_usergroups: # users that are part of any of these groups won't trigger this rule
  - admin-team

start_message_thread: true # start a new thread on the message that triggered the rule

ignore_threads: true # will prevent the rule from triggering inside threaded messages

direct_message_only: false # will only reply via direct message if enabled

limit_to_rooms: # this is an array of rooms/channels where the rule can get triggered.
  - coolchannel

output_to_rooms: # this is an array of rooms/channels you want messages to be sent into in Slack.
  - mychannel

output_to_users: # this is an array of users you want messages to be sent to directly in Slack.
  - John.Doe

respond_to_bots: false # allow responding to other bots

# help
help_text: echo <message> # help/usage text for the echo rule
include_in_help: true # see help_text in help message
disable_no_match_help: false # toggle whether to show help when no match was found
</code></pre>
<ul>
<li><strong>name</strong> (<em>string</em>) Choose a name of the rule. This should match the name of yaml file, should be short and descriptive.</li>
<li><strong>active</strong> (<em>boolean</em>) If set to true, the bot will look for the match in the rooms it is in and take stated actions.</li>
<li><strong>respond</strong> (<em>string</em>) Choose a string to match or regex pattern that this rule should trigger actions for. Regex rules with <a href="https://pkg.go.dev/regexp/syntax#:%7E:text=named%20%26%20numbered%20capturing%20group">named capture groups</a> will be processed as arguments.
<ul>
<li><strong>args</strong> (<em>yaml array</em>) The number of items in this array determines how many args you're trying to capture after the match is found. Each argument captured after the match will be mapped to a variable name you assign in this array. Optional arguments (denoted with a <code>?</code> suffix) have to be listed last - their variable name will not contain the <code>?</code>.</li>
</ul>
</li>
<li><strong>hear</strong> (<em>string</em>) Choose a string to match or regex pattern that this rule should trigger actions for. Hear will match any occurrence of the pattern in the room regardless of whether the bot is addressed. Regex rules with <a href="https://pkg.go.dev/regexp/syntax#:%7E:text=named%20%26%20numbered%20capturing%20group">named capture groups</a> will be processed as arguments.</li>
<li><strong>schedule</strong> (<em>string</em>) <a href="https://godoc.org/github.com/robfig/cron#hdr-CRON_Expression_Format">Cronspec</a> for when you want a rule to run on a schedule.</li>
<li><strong>reaction_added</strong> (<em>string</em>) Choose a string to match or regex pattern that this rule should trigger actions for. Regex rules with <a href="https://pkg.go.dev/regexp/syntax#:%7E:text=named%20%26%20numbered%20capturing%20group">named capture groups</a> will be processed as arguments.</li>
<li><strong>reaction_removed</strong> (<em>string</em>) Choose a string to match or regex pattern that this rule should trigger actions for.  Regex rules with <a href="https://pkg.go.dev/regexp/syntax#:%7E:text=named%20%26%20numbered%20capturing%20group">named capture groups</a> will be processed as arguments.</li>
<li><strong>reaction</strong> (<em>string</em>) Any time a rule is matched by the bot, it will add this reaction to the message that triggered the rule.
<ul>
<li>Slack: A string value of an <a href="https://www.webpagefx.com/tools/emoji-cheat-sheet/">emoji</a> reaction that exists in the server. For example, putting a value of <code>white_check_mark</code> would add the reaction of ✅.</li>
<li>Discord: A string value of an <a href="https://www.webpagefx.com/tools/emoji-cheat-sheet/">emoji</a> reaction that exists in the server. For example, putting a value of ✅ would add the reaction of ✅.</li>
</ul>
</li>
<li><strong>actions</strong> (<em>yaml array</em>) Each item of this array determines sequential actions to take when a match is found. This can range from making an API call to running a script and grabbing the output. An empty actions section will just reply with a message you specify. See the <a href="https://target.github.io/flottbot-docs/rules/anatomy/#action-examples">Actions</a> section below, rule examples for how the framework supports basic bot functions like HTTP requests and script execution. Actions will by default timeout after 10 seconds. If a longer timeout is needed, it is configurable to do so.</li>
<li><strong>format_output</strong> (<em>string</em>) This is the response shown to the user when a match is found, is often passed information from the actions section.</li>
<li><strong>allow_users</strong> (<em>yaml array</em>) An array of users that are permitted to execute this rule.</li>
<li><strong>allow_usergroups</strong> (<em>yaml array</em>) An array of user groups that are permitted to execute this rule. <strong>Important:</strong> To use this feature in Slack, you need to set up your integration as an app (not a regular bot configuration).</li>
<li><strong>ignore_users</strong> (<em>yaml array</em>) An array of users that will not be able to execute this rule.</li>
<li><strong>ignore_usergroups</strong> (<em>yaml array</em>) An array of user groups that will not be able to execute this rule. <strong>Important:</strong> To use this feature in Slack, you need to set up your integration as an app (not a regular bot configuration).</li>
<li><strong>start_message_thread</strong> (<em>boolean</em>) If set to true, the bot start a thread with your trigger message being the parent. Otherwise, the bot will post a message in the same channel.</li>
<li><strong>ignore_threads</strong> (<em>boolean</em>) If set to true, the bot will not be able to get triggered for this rule from within a message a thread.</li>
<li><strong>direct_message_only</strong> (<em>boolean</em>) If set to true, the bot will never respond to this rule in a room it will only direct message the sender.</li>
<li><strong>limit_to_rooms</strong> (<em>yaml array</em>) An array of rooms where the rule can get triggered.</li>
<li><strong>output_to_rooms</strong> (<em>yaml array</em>) An array of rooms you want messages to be sent into.</li>
<li><strong>output_to_users</strong> (<em>yaml array</em>) An array of specific users you want messages to be to.</li>
<li><strong>respond_to_bots</strong> (<em>boolean</em>) If set, other bots are able to trigger your bot.</li>
<li><strong>help_text</strong> (<em>string</em>) This is the response we show to the user when they interact with the bot and no match occurs. We often like to put bot usage instructions for the rule here.</li>
<li><strong>include_in_help</strong> (<em>boolean</em>) If set to true, this will include the help text set above in the help message. Setting to false is good for when you're trying to hide some rules/functionality to end users (perhaps admin-only functions).</li>
<li><strong>disable_no_match_help</strong> (<em>boolean</em>) If set to true, no help message will be shown when the bot is addressed but unable to find a matching rule.</li>
</ul>


                </main>
            </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
            
    
        
        
        
        
            
        
        
            
                
            
                
            
                
            
                
            
                
            
        
        
            
                
            
                
            
                
            
                
            
        
        
            
                
                    
                    <a class="previous" href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;rules&#x2F;"><i class="fa fa-angle-left"></i></a>
                
            
                
            
                
            
        
        
            
        
    


            
    
        <a class="next" href="https:&#x2F;&#x2F;target.github.io&#x2F;flottbot-docs&#x2F;rules&#x2F;variables&#x2F;"><i class="fa fa-angle-right"></i></a>
    

        </nav>

    </div>

    
    <script src="https://target.github.io/flottbot-docs/elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://target.github.io/flottbot-docs/search_index.en.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://target.github.io/flottbot-docs/mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://target.github.io/flottbot-docs/searcher.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://target.github.io/flottbot-docs/clipboard.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://target.github.io/flottbot-docs/highlight.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://target.github.io/flottbot-docs/book.js" type="text/javascript" charset="utf-8"></script>
    
</body>

</html>
